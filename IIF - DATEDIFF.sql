--Comando IIF

SELECT C.CONTRATO,C.TITULO, U.NOME,
IIF(C.STATUS = 1, 'Aprovado',(IIF (C.STATUS = 3, 'Cancelado', 'Outros')))AS STATUS_CONTRATO
FROM contratowf C
INNER JOIN USUARIOS U
ON C.OWNERID = U.ID
where C.ID = 11111111 AND C.OWNERID = 22222222

--Utilizando DATEDIFF – Diferença entre 2 datas

SELECT TOP 10000 MENSAGEM,datediff(minute,DATAENTRADA,DATAPROCESSAMENTO) [minutos],
ENTRADASAIDA,ID,DATAENTRADA,DATAPROCESSAMENTO,DATAPROCESSINICIO,TAMANHO
FROM BrokerMensagem
WHERE DATAENTRADA BETWEEN '2017-01-31 19:00:00.000'
AND '2017-01-31 23:59:00.000'
and datediff(minute,DATAENTRADA,DATAPROCESSAMENTO) > 500
ORDER BY TAMANHO DESC

--exemplo DATEDIFF
SELECT DATEDIFF(year, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(quarter, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(month, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(dayofyear, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(day, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(week, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(hour, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(minute, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(second, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
SELECT DATEDIFF(millisecond, '2005-12-31 23:59:59.9999999', '2006-01-01 00:00:00.0000000');
